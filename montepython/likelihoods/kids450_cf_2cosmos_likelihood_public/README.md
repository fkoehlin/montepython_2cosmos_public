This folder contains the '2cosmos' likelihood module to be used with the KiDS-450 correlation function measurements from [Hildebrandt et al. 2017 (MNRAS, 465, 1454)](http://adsabs.harvard.edu/abs/2017MNRAS.465.1454H). This likelihood was used in the analysis of [Koehlinger et al. 2019 (MNRAS, 484, 3126)](https://ui.adsabs.harvard.edu/abs/2019MNRAS.484.3126K) whenever parameters and evidences for the mutually exclusive split subsets were required. The likelihood can only be run within this modified version of Monte Python, i.e. [montepython_2cosmos_public](https://github.com/fkoehlin/montepython_2cosmos_public) which calls two independent instances of [CLASS](https://github.com/legourg/class_public) (version >= 2.6!) and which also keeps the relevant cosmological parameter dictionaries separate, so that each subset of the mutually exclusive split of the main dataset is assigned its own copy of cosmological (and nuisance) parameters. The two subsets are still coupled through their joint covariance though to properly account for their correlations. To compare the split parameters then to the joint parameters and to compare the evidences for the Bayes factor a comparison run with the regular [kids450_cf_likelihood_public](https://github.com/fkoehlin/kids450_cf_likelihood_public) is required within a standard [MontePython](https://github.com/brinckmann/montepython_public) and [CLASS](https://github.com/lesgourg/class_public) (version >= 2.6!) setup. The required KiDS-450 data files can be downloaded from the [KiDS science data webpage](http://kids.strw.leidenuniv.nl/sciencedata.php) and the parameter file for reproducing the split runs of [Koehlinger et al. 2019 (MNRAS, 484, 3126)](https://ui.adsabs.harvard.edu/abs/2019MNRAS.484.3126K) is supplied in the subfolder `INPUT` within this repository.

Assuming that `montepython_2cosmos_public` (with CLASS version >= 2.6) is set up (we recommend to use a nested-sampling sampler!), please proceed as follows:

1) Set the path to the data folder (i.e. `KiDS-450_COSMIC_SHEAR_DATA_RELEASE` from the tarball available from the [KiDS science data webpage](http://kids.strw.leidenuniv.nl/sciencedata.php')) in `kids450_cf_2cosmos_likelihood_public.data` and modify parameters as you please (note that everything is set up to work with `kids450_cf_2cosmos.param`).

2) Copy the folder `CUT_VALUES` from this repository also into the root data folder (`KiDS-450_COSMIC_SHEAR_DATA_RELEASE`).

3) Start your runs using e.g. the `kids450_cf_2cosmos.param` supplied in the `input` folder within the root-path of `montepython_2cosmos_public`.

4) If you publish your results based on using this likelihood, please cite [Koehlinger et al. 2019 (MNRAS, 484, 3126)](https://ui.adsabs.harvard.edu/abs/2019MNRAS.484.3126K) and please follow the instructions on the [KiDS science data webpage](http://kids.strw.leidenuniv.nl/sciencedata.php) for referencing all relevant sources for the KiDS-450 data. Please cite also all relevant references for the standard MontePython and CLASS.

Refer to `run_kids450_cf_2cosmos_with_multinest.sh` within the `input` folder in the root-path of `montepython_2cosmso_public` for all MultiNest-related settings that were used for the runs.

WARNING: This likelihood only produces valid results for `\Omega_k = 0`, i.e. flat cosmologies!
